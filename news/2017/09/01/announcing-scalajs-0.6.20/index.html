<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/assets/img/scala-js-logo-32.png">
    <link rel="canonical" href="https://www.scala-js.org/news/2017/09/01/announcing-scalajs-0.6.20/">

    <title> Announcing Scala.js 0.6.20 - Scala.js</title>

    <meta property="og:title" content="Announcing Scala.js 0.6.20" /><meta property="og:type" content="article" /><meta property="og:description" content="Build robust front-end web applications in Scala with Scala.js" /><meta property="og:site_name" content="Scala.js" /><meta property="og:image" content="https://www.scala-js.org/assets/img/scala-js-logo-256.png" /><meta property="article:published_time" content="2017-09-01T00:00:00-04:00" /><meta property="article:tag" content="releases" />


    <link type="text/css" rel="stylesheet" href="/assets/bundle-91bdfeed9789c079530f8a6a05da4b23fd93b28c59e0b7729fc9c2199700d3da.css">

    <script>
      var onloadFunctions = [];
    </script>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/"><img width="120" alt="Scala.js" src="/assets/img/scala-js-site-logo.svg"></a>
    </div>
    <div class="navbar-collapse collapse navbar-right">
      <ul class="nav navbar-nav">
        <li ><a href="/doc/">DOCUMENTATION</a></li>
        <li ><a href="/libraries/">LIBRARIES</a></li>
        <li ><a href="/community/">COMMUNITY</a></li>
        <li class="active"><a href="/news/">NEWS</a></li>
        <li><a href="#" id="search-icon"><i style="font-size: 20px" class="fa fa-search"></i></a></li>
      </ul>
    </div>
  </div>
</div>
<div id="search-view" class="container">
    <div id="search-box">
            <input type="text" class="form-control" placeholder="Search" id="search-term">
        <div id="search-results" class="container"></div>
    </div>
</div>
<div id="wrap">
    <div id="main">
        <div id="blue">
    <div class="container">
        <div class="row">
            <h3>Announcing Scala.js 0.6.20</h3>
        </div><!-- /row -->
    </div> <!-- /container -->
</div><!-- /blue -->

<div class="container mtb">
    <div class="row">
        <div class="col-md-12">
            <p>
                <span class="small">Sep 1, 2017.</span>
            </p>
            <p>We are pleased to announce the release of Scala.js 0.6.20!</p>

<p>This release is mostly intended to bridge the gap between the 0.6.x and 1.x branches, to make it easier to cross-compile and/or migrate.</p>

<p>Read on for more details.</p>

<!--more-->

<h2 id="getting-started">Getting started</h2>

<p>If you are new to Scala.js, head over to
<a href="/tutorial/">the tutorial</a>.</p>

<h2 id="release-notes">Release notes</h2>

<p>If upgrading from Scala.js 0.6.14 or earlier, make sure to read <a href="/news/2017/03/21/announcing-scalajs-0.6.15/">the release notes of 0.6.15</a>, which contain important migration information.</p>

<p>As a minor release, 0.6.20 is backward source and binary compatible with previous releases in the 0.6.x series.
Libraries compiled with earlier versions can be used with 0.6.20 without change.
0.6.20 is also forward binary compatible with 0.6.{17-19}, but not with earlier releases: libraries compiled with 0.6.20 cannot be used by projects using 0.6.{0-16}.</p>

<p>Please report any issues <a href="https://github.com/scala-js/scala-js/issues">on GitHub</a>.</p>

<h2 id="breaking-changes">Breaking changes</h2>

<h3 id="sbt-01316-or-above-is-required-or-sbt-1x">sbt 0.13.16 or above is required (or sbt 1.x)</h3>

<p>The sbt plugin of Scala.js 0.6.20 starts using features of sbt 0.13.16.
If you are using an older version of sbt 0.13.x, you will have to upgrade to 0.13.16 or later.</p>

<p>Since 0.6.19, Scala.js also supports sbt 1.0.0+.</p>

<h3 id="scalajs-env-selenium-has-to-be-upgraded-to-020"><code class="highlighter-rouge">scalajs-env-selenium</code> has to be upgraded to 0.2.0</h3>

<p>Scala.js 0.6.20 contains internal changes to improve the so-called test adapter, which is the mechanism used by sbt to communicate with testing frameworks.
These changes are invisible to you, but they broke <a href="https://github.com/scala-js/scala-js-env-selenium"><code class="highlighter-rouge">scalajs-env-selenium</code></a> 0.1.x.
If you use it, you will have to upgrade it to 0.2.0.</p>

<h2 id="deprecations">Deprecations</h2>

<p>Scala.js 0.6.20 introduces more aggressive deprecations for features that will disappear in 1.x.
Note that those features have already had better replacements since Scala.js 0.6.18; we are just making it more obvious that these new features should be used to be compatible with 1.x.</p>

<h3 id="scalajsdefined"><code class="highlighter-rouge">@ScalaJSDefined</code></h3>

<p>This annotation is now deprecated.
Instead of using it, you should add the following to your project settings:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scalacOptions</span> <span class="o">+=</span> <span class="s">"-P:scalajs:sjsDefinedByDefault"</span></code></pre></figure>

<p>and remove the <code class="highlighter-rouge">@ScalaJSDefined</code> annotations everywhere in your codebase.
The semantics of your codebase will be unchanged.</p>

<h3 id="jsjsapp"><code class="highlighter-rouge">js.JSApp</code></h3>

<p><code class="highlighter-rouge">js.JSApp</code> has traditionally provided two services to an <code class="highlighter-rouge">object Foo</code> that extends it.
These two services are replaced by two different features.</p>

<h4 id="discoverability-by-sbt-as-main-object">Discoverability by sbt as main object</h4>

<p>Since Scala.js 0.6.18, the sbt plugin can recognize “standard” <code class="highlighter-rouge">main</code> methods of the form</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">def</span> <span class="n">main</span><span class="o">(</span><span class="n">args</span><span class="k">:</span> <span class="kt">Array</span><span class="o">[</span><span class="kt">String</span><span class="o">])</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">...</span></code></pre></figure>

<p>in objects, even if they do not extend <code class="highlighter-rouge">js.JSApp</code>.
Use such a main method to replace <code class="highlighter-rouge">js.JSApp</code> in the context of discoverability by sbt.</p>

<p>To enable it as main method, make sure you also set</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">scalaJSUseMainModuleInitializer</span> <span class="o">:=</span> <span class="kc">true</span></code></pre></figure>

<p>in your project settings.</p>

<h4 id="automatic-export-to-javascript">Automatic export to JavaScript</h4>

<p>Given</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">package</span> <span class="nn">bar</span>

<span class="k">object</span> <span class="nc">Foo</span> <span class="k">extends</span> <span class="n">js</span><span class="o">.</span><span class="nc">JSApp</span> <span class="o">{</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="n">println</span><span class="o">(</span><span class="s">"Hello world!"</span><span class="o">)</span>
<span class="o">}</span></code></pre></figure>

<p>the object <code class="highlighter-rouge">Foo</code> and its <code class="highlighter-rouge">main</code> method are automatically exported such that JavaScript code can call</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">bar</span><span class="p">.</span><span class="nx">Foo</span><span class="p">().</span><span class="nx">main</span><span class="p">();</span></code></pre></figure>

<p>To achieve exactly the same behavior without <code class="highlighter-rouge">js.JSApp</code>, define <code class="highlighter-rouge">Foo</code> as</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">package</span> <span class="nn">bar</span>

<span class="k">object</span> <span class="nc">Foo</span> <span class="o">{</span>
  <span class="nd">@JSExportTopLevel</span><span class="o">(</span><span class="s">"bar.Foo"</span><span class="o">)</span>
  <span class="k">protected</span> <span class="k">def</span> <span class="n">getInstance</span><span class="o">()</span><span class="k">:</span> <span class="kt">this.</span><span class="k">type</span> <span class="o">=</span> <span class="k">this</span>

  <span class="nd">@JSExport</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="n">println</span><span class="o">(</span><span class="s">"Hello world!"</span><span class="o">)</span>
<span class="o">}</span></code></pre></figure>

<p>Alternatively, you can define it as</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">package</span> <span class="nn">bar</span>

<span class="k">object</span> <span class="nc">Foo</span> <span class="o">{</span>
  <span class="nd">@JSExportTopLevel</span><span class="o">(</span><span class="s">"bar.Foo.main"</span><span class="o">)</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="n">println</span><span class="o">(</span><span class="s">"Hello world!"</span><span class="o">)</span>
<span class="o">}</span></code></pre></figure>

<p>but in that case, the JavaScript code will have to be changed to</p>

<figure class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">bar</span><span class="p">.</span><span class="nx">Foo</span><span class="p">.</span><span class="nx">main</span><span class="p">();</span></code></pre></figure>

<h3 id="jsdependencies--runtimedom-and-requiresdom--true"><code class="highlighter-rouge">jsDependencies += RuntimeDOM</code> and <code class="highlighter-rouge">requiresDOM := true</code></h3>

<p>These settings will not be supported by <a href="https://github.com/scala-js/jsdependencies"><code class="highlighter-rouge">sbt-jsdependencies</code></a> 1.x, the new home of <code class="highlighter-rouge">jsDependencies</code> and related features.</p>

<p>Instead of relying on them to configure a JS environment equipped with the DOM, you should explicitly do so.
For example, to use Node.js with jsdom, use:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">jsEnv</span> <span class="o">:=</span> <span class="k">new</span> <span class="n">org</span><span class="o">.</span><span class="n">scalajs</span><span class="o">.</span><span class="n">jsenv</span><span class="o">.</span><span class="n">jsdomnodejs</span><span class="o">.</span><span class="nc">JSDOMNodeJSEnv</span><span class="o">()</span></code></pre></figure>

<h2 id="new-features">New features</h2>

<h3 id="improved-support-for-cross-compilation-with-1x-and-jsdependencies">Improved support for cross-compilation with 1.x and <code class="highlighter-rouge">jsDependencies</code></h3>

<p><a href="/news/2017/07/03/announcing-scalajs-1.0.0-M1/">The release notes of Scala.js 1.0.0-M1</a> detail how to cross-compile between 0.6.x and 1.x.
One aspect of it was particularly painful: handling the new <code class="highlighter-rouge">JSDependenciesPlugin</code>.
Scala.js 0.6.20 makes this easier by introducing a shim of <code class="highlighter-rouge">JSDependenciesPlugin</code> inside sbt-scalajs.
It is now sufficient to add the following to your <code class="highlighter-rouge">project/plugins.sbt</code>:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="c1">// For jsDependencies
</span><span class="o">{</span>
  <span class="k">if</span> <span class="o">(</span><span class="n">scalaJSVersion</span><span class="o">.</span><span class="n">startsWith</span><span class="o">(</span><span class="s">"0.6."</span><span class="o">))</span> <span class="nc">Nil</span>
  <span class="k">else</span> <span class="nc">Seq</span><span class="o">(</span><span class="n">addSbtPlugin</span><span class="o">(</span><span class="s">"org.scala-js"</span> <span class="o">%</span> <span class="s">"sbt-jsdependencies"</span> <span class="o">%</span> <span class="s">"1.0.0-M1"</span><span class="o">))</span>
<span class="o">}</span></code></pre></figure>

<p>and add <code class="highlighter-rouge">enablePlugins(JSDependenciesPlugin)</code> to the projects that require it.
There is no need for the hacky <code class="highlighter-rouge">project/JSDependenciesCompat.scala</code> anymore.</p>

<h3 id="jdk-apis">JDK APIs</h3>

<p>The following JDK API class has been added:</p>

<ul>
  <li><code class="highlighter-rouge">java.util.SplittableRandom</code></li>
</ul>

<h2 id="bug-fixes">Bug fixes</h2>

<p>The following bugs have been fixed in 0.6.20:</p>

<ul>
  <li><a href="https://github.com/scala-js/scala-js/issues/3107">#3107</a> <code class="highlighter-rouge">ByteArrayOutputStream</code> (and in general all <code class="highlighter-rouge">Closeable</code>s) should be an <code class="highlighter-rouge">AutoCloseable</code></li>
  <li><a href="https://github.com/scala-js/scala-js/issues/3082">#3082</a> Incorrect handling of main generates broken code</li>
</ul>

<p>You can find the full list <a href="https://github.com/scala-js/scala-js/issues?q=is%3Aissue+milestone%3Av0.6.20+is%3Aclosed">on GitHub</a>.</p>

            <div class="spacing"></div>
            <nav>
                <ul class="pager">
                    
                    <li class="previous"><a href="/news/2017/07/29/announcing-scalajs-0.6.19/"
                                            title="Announcing Scala.js 0.6.19">&larr; Previous</a></li>
                    
                    
                    <li class="next"><a href="/news/2017/11/06/announcing-scalajs-0.6.21/"
                                        title="Announcing Scala.js 0.6.21">Next &rarr;</a></li>
                    
                </ul>
            </nav>
        </div>
    </div>
</div>

    </div>
</div>
<div id="footerwrap">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <h4>LEARN</h4>

                <div class="hline-w"></div>
                <a class="grey-text text-lighten-3" href="/doc/">Documentation</a><br/>
                <a class="grey-text text-lighten-3" href="/tutorial/">Tutorial</a><br/>
                <a class="grey-text text-lighten-3" href="/doc/faq.html">FAQ</a>
            </div>
            <div class="col-md-4">
                <h4>COMMUNITY</h4>

                <div class="hline-w"></div>
                <a class="grey-text text-lighten-3" href="https://gitter.im/scala-js/scala-js">Gitter chat</a><br/>
                <a class="grey-text text-lighten-3" href="http://stackoverflow.com/questions/tagged/scala.js">Stackoverflow</a><br/>
                <a class="grey-text text-lighten-3" href="https://groups.google.com/forum/?fromgroups#!forum/scala-js">Mailing list</a><br/>
                <a class="grey-text text-lighten-3" href="http://twitter.com/scala_js">Twitter <i aria-hidden="true" class="fa fa-twitter"></i></a><br/>
                <a href="http://github.com/scala-js/scala-js">GitHub <i aria-hidden="true" class="fa fa-github"></i></a>
            </div>
            <div class="col-md-4">
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
// delay loading of all JS assets only after first render
function downloadJSAtOnload() {
  var element = document.createElement("script");
  element.src = "/assets/bundle-9889fa9840f41fa2ac0f78fcdf8ed4ec89ec5f10123708d991b965a5cad032b1.js";
  document.body.appendChild(element);
}
if (window.addEventListener)
  window.addEventListener("load", downloadJSAtOnload, false);
else if (window.attachEvent)
  window.attachEvent("onload", downloadJSAtOnload);
else window.onload = downloadJSAtOnload;
</script>



</body>
</html>