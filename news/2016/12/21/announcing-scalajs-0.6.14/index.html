<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="/scala-js-website/assets/img/scala-js-logo-32.png">
    <link rel="canonical" href="https://www.scala-js.org/news/2016/12/21/announcing-scalajs-0.6.14/">

    <title> Announcing Scala.js 0.6.14 - Scala.js</title>

    <meta property="og:title" content="Announcing Scala.js 0.6.14" /><meta property="og:type" content="article" /><meta property="og:description" content="Build robust front-end web applications in Scala with Scala.js" /><meta property="og:site_name" content="Scala.js" /><meta property="og:image" content="https://www.scala-js.org/assets/img/scala-js-logo-256.png" /><meta property="article:published_time" content="2016-12-21T00:00:00-05:00" /><meta property="article:tag" content="releases" />


    <link type="text/css" rel="stylesheet" href="/scala-js-website/assets/bundle-91bdfeed9789c079530f8a6a05da4b23fd93b28c59e0b7729fc9c2199700d3da.css">

    <script>
      var onloadFunctions = [];
    </script>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
<div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="/scala-js-website/"><img width="120" alt="Scala.js" src="/scala-js-website/assets/img/scala-js-site-logo.svg"></a>
    </div>
    <div class="navbar-collapse collapse navbar-right">
      <ul class="nav navbar-nav">
        <li ><a href="/scala-js-website/doc/">DOCUMENTATION</a></li>
        <li ><a href="/scala-js-website/libraries/">LIBRARIES</a></li>
        <li ><a href="/scala-js-website/community/">COMMUNITY</a></li>
        <li class="active"><a href="/scala-js-website/news/">NEWS</a></li>
        <li><a href="#" id="search-icon"><i style="font-size: 20px" class="fa fa-search"></i></a></li>
      </ul>
    </div>
  </div>
</div>
<div id="search-view" class="container">
    <div id="search-box">
            <input type="text" class="form-control" placeholder="Search" id="search-term">
        <div id="search-results" class="container"></div>
    </div>
</div>
<div id="wrap">
    <div id="main">
        <div id="blue">
    <div class="container">
        <div class="row">
            <h3>Announcing Scala.js 0.6.14</h3>
        </div><!-- /row -->
    </div> <!-- /container -->
</div><!-- /blue -->

<div class="container mtb">
    <div class="row">
        <div class="col-md-12">
            <p>
                <span class="small">Dec 21, 2016.</span>
            </p>
            <p>We are excited to announce the release of Scala.js 0.6.14!</p>

<p>This release features a few language enhancements for interoperability.
Among others, it allows to export top-level functions, and provides language support for JavaScript “configuration objects”.</p>

<!--more-->

<h2 id="getting-started">Getting started</h2>

<p>If you are new to Scala.js, head over to
<a href="/tutorial/">the tutorial</a>.</p>

<h2 id="release-notes">Release notes</h2>

<p>If upgrading from Scala.js 0.6.12 or earlier, make sure to read <a href="/news/2016/10/17/announcing-scalajs-0.6.13/">the release notes of 0.6.13</a>, which contain some breaking changes in sbt build definitions.</p>

<p>As a minor release, 0.6.14 is backward source and binary compatible with previous releases in the 0.6.x series.
Libraries compiled with earlier versions can be used with 0.6.14 without change.
However, it is not forward compatible: libraries compiled with 0.6.14 cannot be used by projects using 0.6.{0-13}.</p>

<p>Please report any issues <a href="https://github.com/scala-js/scala-js/issues">on GitHub</a>.</p>

<h2 id="javascript-configuration-objects">JavaScript configuration objects</h2>

<p>Many JavaScript libraries expose APIs where options are given in what we call configuration objects.
A well-known example would be the <a href="http://api.jquery.com/jquery.ajax/"><code class="highlighter-rouge">$.ajax()</code></a> function of jQuery, which we can declare as:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nd">@ScalaJSDefined</span>
<span class="k">trait</span> <span class="nc">JQueryAjaxSettings</span> <span class="k">extends</span> <span class="n">js</span><span class="o">.</span><span class="nc">Object</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">data</span><span class="k">:</span> <span class="kt">js.Object</span> <span class="kt">|</span> <span class="kt">String</span> <span class="kt">|</span> <span class="kt">js.Array</span><span class="o">[</span><span class="kt">Any</span><span class="o">]</span>
  <span class="k">val</span> <span class="n">contentType</span><span class="k">:</span> <span class="kt">Boolean</span> <span class="kt">|</span> <span class="kt">String</span>
  <span class="k">val</span> <span class="n">crossDomain</span><span class="k">:</span> <span class="kt">Boolean</span>
  <span class="k">val</span> <span class="n">success</span><span class="k">:</span> <span class="kt">js.Function3</span><span class="o">[</span><span class="kt">Any</span>, <span class="kt">String</span>, <span class="kt">JQueryXHR</span>, <span class="k">_</span><span class="o">]</span>
  <span class="o">...</span>
<span class="o">}</span>

<span class="k">def</span> <span class="n">ajax</span><span class="o">(</span><span class="n">url</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">settings</span><span class="k">:</span> <span class="kt">JQueryAjaxSettings</span><span class="o">)</span><span class="k">:</span> <span class="kt">JQueryXHR</span> <span class="o">=</span> <span class="n">js</span><span class="o">.</span><span class="n">native</span></code></pre></figure>

<p>The <code class="highlighter-rouge">val</code>s need to be declared abstract because, in previous versions of Scala.js, <code class="highlighter-rouge">@ScalaJSDefined</code> traits could not have concrete members.
This makes it tedious to create an instance of <code class="highlighter-rouge">JQueryAjaxSettings</code>, since the Scala type system forces us to fill them in, although the fields are optional in JavaScript.
Previous workarounds include a) using <code class="highlighter-rouge">js.Dynamic.literal(...).asInstanceOf[JQueryAjaxSettings]</code> or b) using <a href="https://github.com/jducoeur/jsext#jsoptionbuilder"><code class="highlighter-rouge">JSOptionBuilder</code></a>.</p>

<p>Scala.js 0.6.14 finally provides language support for this kind of API.
It is now allowed to have concrete members in <code class="highlighter-rouge">@ScalaJSDefined</code> traits, <em>if</em> their right-hand-side is <code class="highlighter-rouge">= js.undefined</code> (this implies that their type must be a supertype of <code class="highlighter-rouge">js.UndefOr[Nothing]</code>).
With this relaxed rule, we can define <code class="highlighter-rouge">JQueryAjaxSettings</code> as follows:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nd">@ScalaJSDefined</span>
<span class="k">trait</span> <span class="nc">JQueryAjaxSettings</span> <span class="k">extends</span> <span class="n">js</span><span class="o">.</span><span class="nc">Object</span> <span class="o">{</span>
  <span class="k">val</span> <span class="n">data</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">js.Object</span> <span class="kt">|</span> <span class="kt">String</span> <span class="kt">|</span> <span class="kt">js.Array</span><span class="o">[</span><span class="kt">Any</span><span class="o">]]</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">undefined</span>
  <span class="k">val</span> <span class="n">contentType</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">Boolean</span> <span class="kt">|</span> <span class="kt">String</span><span class="o">]</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">undefined</span>
  <span class="k">val</span> <span class="n">crossDomain</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">Boolean</span><span class="o">]</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">undefined</span>
  <span class="k">val</span> <span class="n">success</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">js.Function3</span><span class="o">[</span><span class="kt">Any</span>, <span class="kt">String</span>, <span class="kt">JQueryXHR</span>, <span class="k">_</span><span class="o">]]</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">undefined</span>
  <span class="o">...</span>
<span class="o">}</span></code></pre></figure>

<p>When calling <code class="highlighter-rouge">ajax()</code>, we can now give an anonymous object that overrides only the <code class="highlighter-rouge">val</code>s we care about:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">jQuery</span><span class="o">.</span><span class="n">ajax</span><span class="o">(</span><span class="n">someURL</span><span class="o">,</span> <span class="k">new</span> <span class="nc">JQueryAjaxSettings</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">val</span> <span class="n">crossDomain</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">Boolean</span><span class="o">]</span> <span class="k">=</span> <span class="kc">true</span>
  <span class="k">override</span> <span class="k">val</span> <span class="n">success</span><span class="k">:</span> <span class="kt">js.UndefOr</span><span class="o">[</span><span class="kt">js.Function3</span><span class="o">[</span><span class="kt">Any</span>, <span class="kt">String</span>, <span class="kt">JQueryXHR</span>, <span class="k">_</span><span class="o">]]</span> <span class="k">=</span> <span class="o">{</span>
    <span class="n">js</span><span class="o">.</span><span class="n">defined</span> <span class="o">{</span> <span class="o">(</span><span class="n">data</span><span class="k">:</span> <span class="kt">Any</span><span class="o">,</span> <span class="n">textStatus</span><span class="k">:</span> <span class="kt">String</span><span class="o">,</span> <span class="n">xhr</span><span class="k">:</span> <span class="kt">JQueryXHR</span><span class="o">)</span> <span class="k">=&gt;</span>
      <span class="n">println</span><span class="o">(</span><span class="s">"Status: "</span> <span class="o">+</span> <span class="n">textStatus</span><span class="o">)</span>
    <span class="o">}</span>
  <span class="o">}</span>
<span class="o">})</span></code></pre></figure>

<p>Note that for functions, we use <code class="highlighter-rouge">js.defined { ... }</code> to drive Scala’s type inference.
Otherwise, it needs to apply two implicit conversions, which is not allowed.</p>

<p>The explicit types are still quite annoying, but they are only necessary in Scala 2.10 and 2.11.
If you use Scala 2.12, you can omit all the type annotations (but keep <code class="highlighter-rouge">js.defined</code>), thanks to improved type inference for <code class="highlighter-rouge">val</code>s and SAM conversions:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="n">jQuery</span><span class="o">.</span><span class="n">ajax</span><span class="o">(</span><span class="n">someURL</span><span class="o">,</span> <span class="k">new</span> <span class="nc">JQueryAjaxSettings</span> <span class="o">{</span>
  <span class="k">override</span> <span class="k">val</span> <span class="n">crossDomain</span> <span class="k">=</span> <span class="kc">true</span>
  <span class="k">override</span> <span class="k">val</span> <span class="n">success</span> <span class="k">=</span> <span class="n">js</span><span class="o">.</span><span class="n">defined</span> <span class="o">{</span> <span class="o">(</span><span class="n">data</span><span class="o">,</span> <span class="n">textStatus</span><span class="o">,</span> <span class="n">xhr</span><span class="o">)</span> <span class="k">=&gt;</span>
    <span class="n">println</span><span class="o">(</span><span class="s">"Status: "</span> <span class="o">+</span> <span class="n">textStatus</span><span class="o">)</span>
  <span class="o">}</span>
<span class="o">})</span></code></pre></figure>

<h2 id="export-top-level-functions">Export top-level functions</h2>

<p>In Scala.js 0.6.13 and earlier, the only way to export something resembling a top-level function was to export the method and its enclosing object, as follows:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="nd">@JSExport</span>
<span class="k">object</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="nd">@JSExport</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>However, this requires to call it as <code class="highlighter-rouge">Main().main()</code> from JavaScript, which shows that it is not actually a top-level function.</p>

<p>In Scala.js 0.6.14, you can use the <code class="highlighter-rouge">@JSExportTopLevel</code> annotation instead:</p>

<figure class="highlight"><pre><code class="language-scala" data-lang="scala"><span class="k">object</span> <span class="nc">Main</span> <span class="o">{</span>
  <span class="nd">@JSExportTopLevel</span><span class="o">(</span><span class="s">"main"</span><span class="o">)</span>
  <span class="k">def</span> <span class="n">main</span><span class="o">()</span><span class="k">:</span> <span class="kt">Unit</span> <span class="o">=</span> <span class="o">{</span> <span class="o">...</span> <span class="o">}</span>
<span class="o">}</span></code></pre></figure>

<p>which allows to call <code class="highlighter-rouge">main()</code> from JavaScript.
<code class="highlighter-rouge">@JSExportTopLevel</code> methods must be declared in top-level <code class="highlighter-rouge">object</code>s.</p>

<h2 id="bug-fixes">Bug fixes</h2>

<p>Among others, the following bugs have been fixed in 0.6.14:</p>

<ul>
  <li><a href="https://github.com/scala-js/scala-js/issues/2587">#2587</a> Incorrect result for <code class="highlighter-rouge">BigDecimal</code> multiplication (corner case)</li>
  <li><a href="https://github.com/scala-js/scala-js/issues/2639">#2639</a> The linker should refuse to build if <code class="highlighter-rouge">@JSImport</code> is used with <code class="highlighter-rouge">NoModule</code></li>
  <li><a href="https://github.com/scala-js/scala-js/issues/2640">#2640</a> <code class="highlighter-rouge">TimeoutException</code> when running PhantomJS with macOS Sierra</li>
  <li><a href="https://github.com/scala-js/scala-js/issues/2643">#2643</a> <code class="highlighter-rouge">js.ThisFunction</code> passing Scala-<code class="highlighter-rouge">this</code> instead of JS-<code class="highlighter-rouge">this</code> when using Scala 2.12.0</li>
  <li><a href="https://github.com/scala-js/scala-js/issues/2655">#2655</a> Inconsistent behavior in <code class="highlighter-rouge">NumericRange.min</code> method between JVM and JS</li>
  <li><a href="https://github.com/scala-js/scala-js/issues/2689">#2689</a> The optimizer does something wrong with <code class="highlighter-rouge">return</code> inside <code class="highlighter-rouge">finally</code></li>
</ul>

<p>You can find the full list <a href="https://github.com/scala-js/scala-js/issues?q=is%3Aissue+milestone%3Av0.6.14+is%3Aclosed">on GitHub</a>.</p>

            <div class="spacing"></div>
            <nav>
                <ul class="pager">
                    
                    <li class="previous"><a href="/scala-js-website/news/2016/10/17/announcing-scalajs-0.6.13/"
                                            title="Announcing Scala.js 0.6.13">&larr; Previous</a></li>
                    
                    
                    <li class="next"><a href="/scala-js-website/news/2017/03/21/announcing-scalajs-0.6.15/"
                                        title="Announcing Scala.js 0.6.15">Next &rarr;</a></li>
                    
                </ul>
            </nav>
        </div>
    </div>
</div>

    </div>
</div>
<div id="footerwrap">
    <div class="container">
        <div class="row">
            <div class="col-md-4">
                <h4>LEARN</h4>

                <div class="hline-w"></div>
                <a class="grey-text text-lighten-3" href="/scala-js-website/doc/">Documentation</a><br/>
                <a class="grey-text text-lighten-3" href="/scala-js-website/tutorial/">Tutorial</a><br/>
                <a class="grey-text text-lighten-3" href="/scala-js-website/doc/faq.html">FAQ</a>
            </div>
            <div class="col-md-4">
                <h4>COMMUNITY</h4>

                <div class="hline-w"></div>
                <a class="grey-text text-lighten-3" href="https://gitter.im/scala-js/scala-js">Gitter chat</a><br/>
                <a class="grey-text text-lighten-3" href="http://stackoverflow.com/questions/tagged/scala.js">Stackoverflow</a><br/>
                <a class="grey-text text-lighten-3" href="https://groups.google.com/forum/?fromgroups#!forum/scala-js">Mailing list</a><br/>
                <a class="grey-text text-lighten-3" href="http://twitter.com/scala_js">Twitter <i aria-hidden="true" class="fa fa-twitter"></i></a><br/>
                <a href="http://github.com/scala-js/scala-js">GitHub <i aria-hidden="true" class="fa fa-github"></i></a>
            </div>
            <div class="col-md-4">
            </div>
        </div>
    </div>
</div>


<script type="text/javascript">
// delay loading of all JS assets only after first render
function downloadJSAtOnload() {
  var element = document.createElement("script");
  element.src = "/scala-js-website/assets/bundle-9889fa9840f41fa2ac0f78fcdf8ed4ec89ec5f10123708d991b965a5cad032b1.js";
  document.body.appendChild(element);
}
if (window.addEventListener)
  window.addEventListener("load", downloadJSAtOnload, false);
else if (window.attachEvent)
  window.attachEvent("onload", downloadJSAtOnload);
else window.onload = downloadJSAtOnload;
</script>



</body>
</html>